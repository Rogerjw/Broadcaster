{"version":3,"sources":["../../server/middlewares/token.middleware.js"],"names":["verifyToken","req","res","next","token","header","status","send","message","verified","jwt","verify","isUserValid","users","find","user","email","error"],"mappings":";;;;;;;AAAA;;AACA;;;;AAEA,IAAMA,WAAW,GAAG,SAAdA,WAAc,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACtC,MAAMC,KAAK,GAAGH,GAAG,CAACI,MAAJ,CAAW,OAAX,CAAd;;AAEA,MAAI,CAACD,KAAL,EAAY;AACV,WAAOF,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,MAAAA,MAAM,EAAE,GADkB;AAE1BE,MAAAA,OAAO,EAAE;AAFiB,KAArB,CAAP;AAID;;AAED,MAAI;AACF,QAAMC,QAAQ,GAAGC,yBAAIC,MAAJ,CAAWP,KAAX,EAAkB,eAAlB,CAAjB;;AACA,QAAMQ,WAAW,GAAGC,YAAMC,IAAN,CAAW,UAACC,IAAD;AAAA,aAAUA,IAAI,CAACC,KAAL,KAAeP,QAAQ,CAACO,KAAlC;AAAA,KAAX,CAApB;;AACA,QAAI,CAACJ,WAAL,EAAkB;AAChB,aAAOV,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,QAAAA,MAAM,EAAE,GADkB;AAE1BE,QAAAA,OAAO,EAAE;AAFiB,OAArB,CAAP;AAID;;AACDP,IAAAA,GAAG,CAACc,IAAJ,GAAWH,WAAX;AACAT,IAAAA,IAAI;AACL,GAXD,CAWE,OAAOc,KAAP,EAAc;AACd,WAAOf,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,MAAAA,MAAM,EAAE,GADkB;AAE1BE,MAAAA,OAAO,EAAES,KAAK,CAACT;AAFW,KAArB,CAAP;AAID;;AACD,SAAO,CAAP;AACD,CA5BD;;eA6BeR,W","sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport { users } from '../models/data';\r\n\r\nconst verifyToken = (req, res, next) => {\r\n  const token = req.header('token');\r\n\r\n  if (!token) {\r\n    return res.status(401).send({\r\n      status: 401,\r\n      message: 'Please sign in first.',\r\n    });\r\n  }\r\n\r\n  try {\r\n    const verified = jwt.verify(token, 'jwtPrivateKey');\r\n    const isUserValid = users.find((user) => user.email === verified.email);\r\n    if (!isUserValid) {\r\n      return res.status(400).send({\r\n        status: 400,\r\n        message: 'Invalid token!'\r\n      });\r\n    }\r\n    req.user = isUserValid;\r\n    next();\r\n  } catch (error) {\r\n    return res.status(400).send({\r\n      status: 400,\r\n      message: error.message\r\n    });\r\n  }\r\n  return 0;\r\n};\r\nexport default verifyToken;"],"file":"token.middleware.js"}